<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C++ Actor Framework: Binary Actor System Protocol</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">C++ Actor Framework<span id="projectnumber">&#160;0.19</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">Binary Actor System Protocol</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcaf_1_1io_1_1basp_1_1header.html">caf::io::basp::header</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The header of a Binary Actor System Protocol (BASP) message.  <a href="structcaf_1_1io_1_1basp_1_1header.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcaf_1_1io_1_1basp_1_1instance.html">caf::io::basp::instance</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describes a protocol instance managing multiple connections.  <a href="classcaf_1_1io_1_1basp_1_1instance.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcaf_1_1io_1_1basp_1_1routing__table.html">caf::io::basp::routing_table</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores routing information for a single broker participating as BASP peer and provides both direct and indirect paths.  <a href="classcaf_1_1io_1_1basp_1_1routing__table.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga93565d04c32ae7fd8541faa8528137c9" id="r_ga93565d04c32ae7fd8541faa8528137c9"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga93565d04c32ae7fd8541faa8528137c9">caf::io::basp::connection_state</a> { <br />
&#160;&#160;<a class="el" href="#gga93565d04c32ae7fd8541faa8528137c9ab632df1733e0ccd53ec8ed82f3c1ad29">caf::io::basp::await_header</a>
, <br />
&#160;&#160;<a class="el" href="#gga93565d04c32ae7fd8541faa8528137c9a9012c932797a2c62391d4b36250fddbf">caf::io::basp::await_payload</a>
, <br />
&#160;&#160;<a class="el" href="#gga93565d04c32ae7fd8541faa8528137c9aa8cc7b137ae9f75c5adad2ea8e58a3e9">caf::io::basp::close_connection</a>
, <br />
&#160;&#160;<a class="el" href="#gga93565d04c32ae7fd8541faa8528137c9ae76bfdcf248c09f33495a0707df3a91e">caf::io::basp::incompatible_versions</a>
, <br />
&#160;&#160;<a class="el" href="#gga93565d04c32ae7fd8541faa8528137c9a43259c3224a72abce20646a3a0b802e3">caf::io::basp::incompatible_application_ids</a>
, <br />
&#160;&#160;<a class="el" href="#gga93565d04c32ae7fd8541faa8528137c9a4ad1435970432a92c02447b0da193148">caf::io::basp::malformed_message</a>
, <br />
&#160;&#160;<a class="el" href="#gga93565d04c32ae7fd8541faa8528137c9a0d94b3fc36be0772b6cfe6c0ea177c84">caf::io::basp::serializing_basp_payload_failed</a>
, <br />
&#160;&#160;<a class="el" href="#gga93565d04c32ae7fd8541faa8528137c9a7e0ee3506c23e90680d5f7763187a7ec">caf::io::basp::redundant_connection</a>
, <br />
&#160;&#160;<a class="el" href="#gga93565d04c32ae7fd8541faa8528137c9a6a0066528a9709ec31fc69a499501d6c">caf::io::basp::no_route_to_receiving_node</a>
<br />
 }</td></tr>
<tr class="memdesc:ga93565d04c32ae7fd8541faa8528137c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Denotes the state of a connection between two BASP nodes.  <a href="#ga93565d04c32ae7fd8541faa8528137c9">More...</a><br /></td></tr>
<tr class="separator:ga93565d04c32ae7fd8541faa8528137c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab4a80a50db79ed975f645501bbf1a8fa" id="r_gab4a80a50db79ed975f645501bbf1a8fa"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab4a80a50db79ed975f645501bbf1a8fa">caf::io::basp::message_type</a> : uint8_t { <br />
&#160;&#160;<a class="el" href="#ggab4a80a50db79ed975f645501bbf1a8faa68f1851994f5966b59d2bd3ffb3fcfa5">message_type::server_handshake</a> = 0x00
, <br />
&#160;&#160;<a class="el" href="#ggab4a80a50db79ed975f645501bbf1a8faa755176cd4556f0782f82bf7e169fc550">message_type::client_handshake</a> = 0x01
, <br />
&#160;&#160;<a class="el" href="#ggab4a80a50db79ed975f645501bbf1a8faa9be42dd11086aff54e44377255afc73b">message_type::direct_message</a> = 0x02
, <br />
&#160;&#160;<a class="el" href="#ggab4a80a50db79ed975f645501bbf1a8faa13a2104d37c15f89d76984ad250b4dac">message_type::routed_message</a> = 0x03
, <br />
&#160;&#160;<a class="el" href="#ggab4a80a50db79ed975f645501bbf1a8faab9538bc5d61173a7f4725e897a965f34">message_type::monitor_message</a> = 0x04
, <br />
&#160;&#160;<a class="el" href="#ggab4a80a50db79ed975f645501bbf1a8faa6bb532f246f78ce5fd450ab16f5f2026">message_type::down_message</a> = 0x05
, <br />
&#160;&#160;<a class="el" href="#ggab4a80a50db79ed975f645501bbf1a8faa3a06e053a0726537b202ce4ace81dee7">message_type::heartbeat</a> = 0x06
<br />
 }</td></tr>
<tr class="memdesc:gab4a80a50db79ed975f645501bbf1a8fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describes the first header field of a BASP message and determines the interpretation of the other header fields.  <a href="#gab4a80a50db79ed975f645501bbf1a8fa">More...</a><br /></td></tr>
<tr class="separator:gab4a80a50db79ed975f645501bbf1a8fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga27e0a1e9ab60e72f991461ffb75f1ed2" id="r_ga27e0a1e9ab60e72f991461ffb75f1ed2"><td class="memItemLeft" align="right" valign="top"><a id="ga27e0a1e9ab60e72f991461ffb75f1ed2" name="ga27e0a1e9ab60e72f991461ffb75f1ed2"></a>
constexpr bool&#160;</td><td class="memItemRight" valign="bottom"><b>caf::io::basp::requires_shutdown</b> (<a class="el" href="#ga93565d04c32ae7fd8541faa8528137c9">connection_state</a> x) noexcept</td></tr>
<tr class="memdesc:ga27e0a1e9ab60e72f991461ffb75f1ed2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the connection state requires a shutdown of the socket connection. <br /></td></tr>
<tr class="separator:ga27e0a1e9ab60e72f991461ffb75f1ed2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaee0c93683f370496d4df9eed904c48c4" id="r_gaee0c93683f370496d4df9eed904c48c4"><td class="memItemLeft" align="right" valign="top">sec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaee0c93683f370496d4df9eed904c48c4">caf::io::basp::to_sec</a> (<a class="el" href="#ga93565d04c32ae7fd8541faa8528137c9">connection_state</a> x) noexcept</td></tr>
<tr class="memdesc:gaee0c93683f370496d4df9eed904c48c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts the connection state to a system error code if it holds one of the overlapping values.  <br /></td></tr>
<tr class="separator:gaee0c93683f370496d4df9eed904c48c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad5323663fbe69cdc954c996ebaf3d00b" id="r_gad5323663fbe69cdc954c996ebaf3d00b"><td class="memItemLeft" align="right" valign="top"><a id="gad5323663fbe69cdc954c996ebaf3d00b" name="gad5323663fbe69cdc954c996ebaf3d00b"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>caf::io::basp::is_handshake</b> (const <a class="el" href="structcaf_1_1io_1_1basp_1_1header.html">header</a> &amp;hdr)</td></tr>
<tr class="memdesc:gad5323663fbe69cdc954c996ebaf3d00b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether given header contains a handshake. <br /></td></tr>
<tr class="separator:gad5323663fbe69cdc954c996ebaf3d00b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae0c3652bce285a4f214828206eb3ffeb" id="r_gae0c3652bce285a4f214828206eb3ffeb"><td class="memItemLeft" align="right" valign="top"><a id="gae0c3652bce285a4f214828206eb3ffeb" name="gae0c3652bce285a4f214828206eb3ffeb"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>caf::io::basp::is_heartbeat</b> (const <a class="el" href="structcaf_1_1io_1_1basp_1_1header.html">header</a> &amp;hdr)</td></tr>
<tr class="memdesc:gae0c3652bce285a4f214828206eb3ffeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether given header contains a heartbeat. <br /></td></tr>
<tr class="separator:gae0c3652bce285a4f214828206eb3ffeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa2abf37d59ec5cabc92c2f0dd95b8bc0" id="r_gaa2abf37d59ec5cabc92c2f0dd95b8bc0"><td class="memItemLeft" align="right" valign="top"><a id="gaa2abf37d59ec5cabc92c2f0dd95b8bc0" name="gaa2abf37d59ec5cabc92c2f0dd95b8bc0"></a>
CAF_IO_EXPORT std::string&#160;</td><td class="memItemRight" valign="bottom"><b>caf::io::basp::to_string</b> (<a class="el" href="#gab4a80a50db79ed975f645501bbf1a8fa">message_type</a>)</td></tr>
<tr class="separator:gaa2abf37d59ec5cabc92c2f0dd95b8bc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga238404883450ec119327aa25f60c1c00" id="r_ga238404883450ec119327aa25f60c1c00"><td class="memItemLeft" align="right" valign="top"><a id="ga238404883450ec119327aa25f60c1c00" name="ga238404883450ec119327aa25f60c1c00"></a>
CAF_IO_EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><b>caf::io::basp::from_string</b> (std::string_view, <a class="el" href="#gab4a80a50db79ed975f645501bbf1a8fa">message_type</a> &amp;)</td></tr>
<tr class="separator:ga238404883450ec119327aa25f60c1c00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7f54d0c98ffc8552661953996db59e6c" id="r_ga7f54d0c98ffc8552661953996db59e6c"><td class="memItemLeft" align="right" valign="top"><a id="ga7f54d0c98ffc8552661953996db59e6c" name="ga7f54d0c98ffc8552661953996db59e6c"></a>
CAF_IO_EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><b>caf::io::basp::from_integer</b> (std::underlying_type_t&lt; <a class="el" href="#gab4a80a50db79ed975f645501bbf1a8fa">message_type</a> &gt;, <a class="el" href="#gab4a80a50db79ed975f645501bbf1a8fa">message_type</a> &amp;)</td></tr>
<tr class="separator:ga7f54d0c98ffc8552661953996db59e6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6807fcd3c1d1a56885f531405ccf21cd" id="r_ga6807fcd3c1d1a56885f531405ccf21cd"><td class="memTemplParams" colspan="2"><a id="ga6807fcd3c1d1a56885f531405ccf21cd" name="ga6807fcd3c1d1a56885f531405ccf21cd"></a>
template&lt;class Inspector &gt; </td></tr>
<tr class="memitem:ga6807fcd3c1d1a56885f531405ccf21cd"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><b>caf::io::basp::inspect</b> (Inspector &amp;f, <a class="el" href="#gab4a80a50db79ed975f645501bbf1a8fa">message_type</a> &amp;x)</td></tr>
<tr class="separator:ga6807fcd3c1d1a56885f531405ccf21cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5a098f4312e1a03bad903b540e7eca7e" id="r_ga5a098f4312e1a03bad903b540e7eca7e"><td class="memTemplParams" colspan="2"><a id="ga5a098f4312e1a03bad903b540e7eca7e" name="ga5a098f4312e1a03bad903b540e7eca7e"></a>
template&lt;class Inspector &gt; </td></tr>
<tr class="memitem:ga5a098f4312e1a03bad903b540e7eca7e"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><b>inspect</b> (Inspector &amp;f, <a class="el" href="structcaf_1_1io_1_1basp_1_1header.html">header</a> &amp;x)</td></tr>
<tr class="separator:ga5a098f4312e1a03bad903b540e7eca7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6470efb9799a1ddfff6239492ee243ec" id="r_ga6470efb9799a1ddfff6239492ee243ec"><td class="memItemLeft" align="right" valign="top"><a id="ga6470efb9799a1ddfff6239492ee243ec" name="ga6470efb9799a1ddfff6239492ee243ec"></a>
CAF_IO_EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><b>valid</b> (const <a class="el" href="structcaf_1_1io_1_1basp_1_1header.html">header</a> &amp;hdr)</td></tr>
<tr class="memdesc:ga6470efb9799a1ddfff6239492ee243ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether given BASP header is valid. <br /></td></tr>
<tr class="separator:ga6470efb9799a1ddfff6239492ee243ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gac9a0c0d3a0eb73be7c7149c7c124220a" id="r_gac9a0c0d3a0eb73be7c7149c7c124220a"><td class="memItemLeft" align="right" valign="top">constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac9a0c0d3a0eb73be7c7149c7c124220a">header_size</a></td></tr>
<tr class="memdesc:gac9a0c0d3a0eb73be7c7149c7c124220a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of a BASP header in serialized form.  <br /></td></tr>
<tr class="separator:gac9a0c0d3a0eb73be7c7149c7c124220a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga81b3b888e54afd4539b1a50e41fda817" id="r_ga81b3b888e54afd4539b1a50e41fda817"><td class="memItemLeft" align="right" valign="top"><a id="ga81b3b888e54afd4539b1a50e41fda817" name="ga81b3b888e54afd4539b1a50e41fda817"></a>
constexpr uint64_t&#160;</td><td class="memItemRight" valign="bottom"><b>caf::io::basp::version</b> = 8</td></tr>
<tr class="memdesc:ga81b3b888e54afd4539b1a50e41fda817"><td class="mdescLeft">&#160;</td><td class="mdescRight">The current BASP version. Note: BASP is not backwards compatible. <br /></td></tr>
<tr class="separator:ga81b3b888e54afd4539b1a50e41fda817"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h1><a class="anchor" id="autotoc_md2"></a>
Protocol Overview</h1>
<p>The "Binary Actor System Protocol" (BASP) is <b>not</b> a network protocol. It is a specification for the "Remote Method Invocation" (RMI) interface used by distributed instances of CAF. The purpose of BASP is unify the structure of RMI calls in order to simplify processing and implementation. Hence, BASP is independent of any underlying network technology, and assumes a reliable communication channel.</p>
<p>The RMI interface of CAF enables network-transparent monitoring and linking as well as global message dispatching to actors running on different nodes.</p>
<div class="image">
<img src="basp_overview.png" alt=""/>
</div>
    <p>The figure above illustrates the physical as well as the logical view of a distributed CAF application. Note that the actors used for the BASP communication ("BASP Brokers") are not part of the logical system view and are in fact not visible to other actors. A BASP Broker creates proxy actors that represent actors running on different nodes. It is worth mentioning that two instances of CAF running on the same physical machine are considered two different nodes in BASP.</p>
<p>BASP has two objectives:</p>
<ul>
<li><p class="startli"><b>Forward messages sent to a proxy to the actor it represents</b></p>
<p class="startli">Whenever a proxy instance receives a message, it forwards this message to its parent (a BASP Broker). This message is then serialized and forwarded over the network. If no direct connection between the node sending the message and the node receiving it exists, intermediate BASP Brokers will forward it until it the message reaches its destination.</p>
</li>
<li><p class="startli"><b>Synchronize the state of an actor with all of its proxies</b>.</p>
<p class="startli">Whenever a node learns the address of a remotely running actor, it creates Ma local proxy instance representing this actor and sends an <code>announce_proxy_instance</code> to the node hosting the actor. Whenever an actor terminates, the hosting node sends <code>down_message</code> messages to all nodes that have a proxy for this actor. This enables network-transparent actor monitoring. There are two possible ways addresses can be learned:</p><ul>
<li>A client connects to a remotely running (published) actor via <code>remote_actor</code>. In this case, the <code>server_handshake</code> will contain the address of the published actor.</li>
<li>Receiving <code>dispatch_message</code>. Whenever an actor message arrives, it usually contains the address of the sender. Further, the message itself can contain addresses to other actors that the BASP Broker will get aware of while deserializing the message object from the payload.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Node IDs</h1>
<p>The ID of a node consists of a 120 bit hash and the process ID. Note that we use "node" as a synonym for "CAF instance". The hash is generated from "low-level" characteristics of a machine such as the UUID of the root file system and available MAC addresses. The only purpose of the node ID is to generate a network-wide unique identifier. By adding the process ID, CAF disambiguates multiple instances running on the same phyisical machine.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Header Format</h1>
<div class="image">
<img src="basp_header.png" alt=""/>
</div>
    <ul>
<li><p class="startli"><b>Operation ID</b>: 4 bytes.</p>
<p class="startli">This field indicates what BASP function this datagram represents. The value is an <code>uint32_t</code> representation of <code>message_type</code>.</p>
</li>
<li><p class="startli"><b>Payload Length</b>: 4 bytes.</p>
<p class="startli">The length of the data following this header as <code>uint32_t</code>, measured in bytes.</p>
</li>
<li><p class="startli"><b>Operation Data</b>: 8 bytes.</p>
<p class="startli">This field contains.</p>
</li>
<li><p class="startli"><b>Source Node ID</b>: 18 bytes.</p>
<p class="startli">The address of the source node. See Node IDs.</p>
</li>
<li><p class="startli"><b>Destination Node ID</b>: 18 bytes.</p>
<p class="startli">The address of the destination node. See Node IDs. Upon receiving this datagram, a BASP Broker compares this node ID to its own ID. On a mismatch, it selects the next hop and forwards this datagram unchanged.</p>
</li>
<li><p class="startli"><b>Source Actor ID</b>: 4 bytes.</p>
<p class="startli">This field contains the ID of the sending actor or 0 for anonymously sent messages. The <em>full address</em> of an actor is the combination of the node ID and the actor ID. Thus, every actor can be unambigiously identified by combining these two IDs.</p>
</li>
<li><p class="startli"><b>Destination Actor ID</b>: 4 bytes.</p>
<p class="startli">This field contains the ID of the receiving actor or 0 for BASP functions that do not require</p>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Example</h1>
<p>The following diagram models a distributed application with three nodes. The pseudo code for the application can be found in the three grey boxes, while the resulting BASP messaging is shown in UML sequence diagram notation. More details about individual BASP message types can be found in the documentation of <code><a class="el" href="#gab4a80a50db79ed975f645501bbf1a8fa">message_type</a></code> below.</p>
<div class="image">
<img src="basp_sequence.png" alt=""/>
</div>
     <h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga93565d04c32ae7fd8541faa8528137c9" name="ga93565d04c32ae7fd8541faa8528137c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga93565d04c32ae7fd8541faa8528137c9">&#9670;&#160;</a></span>connection_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ga93565d04c32ae7fd8541faa8528137c9">caf::io::basp::connection_state</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Denotes the state of a connection between two BASP nodes. </p>
<p>Overlaps with <code>sec</code> (these states get converted to an error by the BASP instance). </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga93565d04c32ae7fd8541faa8528137c9ab632df1733e0ccd53ec8ed82f3c1ad29" name="gga93565d04c32ae7fd8541faa8528137c9ab632df1733e0ccd53ec8ed82f3c1ad29"></a>await_header&#160;</td><td class="fielddoc"><p>Indicates that a connection is established and this node is waiting for the next BASP header. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga93565d04c32ae7fd8541faa8528137c9a9012c932797a2c62391d4b36250fddbf" name="gga93565d04c32ae7fd8541faa8528137c9a9012c932797a2c62391d4b36250fddbf"></a>await_payload&#160;</td><td class="fielddoc"><p>Indicates that this node has received a header with non-zero payload and is waiting for the data. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga93565d04c32ae7fd8541faa8528137c9aa8cc7b137ae9f75c5adad2ea8e58a3e9" name="gga93565d04c32ae7fd8541faa8528137c9aa8cc7b137ae9f75c5adad2ea8e58a3e9"></a>close_connection&#160;</td><td class="fielddoc"><p>Indicates that this connection no longer exists. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga93565d04c32ae7fd8541faa8528137c9ae76bfdcf248c09f33495a0707df3a91e" name="gga93565d04c32ae7fd8541faa8528137c9ae76bfdcf248c09f33495a0707df3a91e"></a>incompatible_versions&#160;</td><td class="fielddoc"><p>See <code>sec::incompatible_versions</code>. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga93565d04c32ae7fd8541faa8528137c9a43259c3224a72abce20646a3a0b802e3" name="gga93565d04c32ae7fd8541faa8528137c9a43259c3224a72abce20646a3a0b802e3"></a>incompatible_application_ids&#160;</td><td class="fielddoc"><p>See <code>sec::incompatible_application_ids</code>. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga93565d04c32ae7fd8541faa8528137c9a4ad1435970432a92c02447b0da193148" name="gga93565d04c32ae7fd8541faa8528137c9a4ad1435970432a92c02447b0da193148"></a>malformed_message&#160;</td><td class="fielddoc"><p>See <code>sec::malformed_message</code>. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga93565d04c32ae7fd8541faa8528137c9a0d94b3fc36be0772b6cfe6c0ea177c84" name="gga93565d04c32ae7fd8541faa8528137c9a0d94b3fc36be0772b6cfe6c0ea177c84"></a>serializing_basp_payload_failed&#160;</td><td class="fielddoc"><p>See <code>sec::serializing_basp_payload_failed</code>. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga93565d04c32ae7fd8541faa8528137c9a7e0ee3506c23e90680d5f7763187a7ec" name="gga93565d04c32ae7fd8541faa8528137c9a7e0ee3506c23e90680d5f7763187a7ec"></a>redundant_connection&#160;</td><td class="fielddoc"><p>See <code>sec::redundant_connection</code>. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga93565d04c32ae7fd8541faa8528137c9a6a0066528a9709ec31fc69a499501d6c" name="gga93565d04c32ae7fd8541faa8528137c9a6a0066528a9709ec31fc69a499501d6c"></a>no_route_to_receiving_node&#160;</td><td class="fielddoc"><p>See <code>sec::no_route_to_receiving_node</code>. </p>
</td></tr>
</table>

</div>
</div>
<a id="gab4a80a50db79ed975f645501bbf1a8fa" name="gab4a80a50db79ed975f645501bbf1a8fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab4a80a50db79ed975f645501bbf1a8fa">&#9670;&#160;</a></span>message_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="#gab4a80a50db79ed975f645501bbf1a8fa">caf::io::basp::message_type</a> : uint8_t</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Describes the first header field of a BASP message and determines the interpretation of the other header fields. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggab4a80a50db79ed975f645501bbf1a8faa68f1851994f5966b59d2bd3ffb3fcfa5" name="ggab4a80a50db79ed975f645501bbf1a8faa68f1851994f5966b59d2bd3ffb3fcfa5"></a>server_handshake&#160;</td><td class="fielddoc"><p>Send from server, i.e., the node with a published actor, to client, i.e., node that initiates a new connection using remote_actor(). </p>
<div class="image">
<img src="server_handshake.png" alt=""/>
</div>
     </td></tr>
<tr><td class="fieldname"><a id="ggab4a80a50db79ed975f645501bbf1a8faa755176cd4556f0782f82bf7e169fc550" name="ggab4a80a50db79ed975f645501bbf1a8faa755176cd4556f0782f82bf7e169fc550"></a>client_handshake&#160;</td><td class="fielddoc"><p>Send from client to server after it has successfully received the server_handshake to establish the connection. </p>
<div class="image">
<img src="client_handshake.png" alt=""/>
</div>
     </td></tr>
<tr><td class="fieldname"><a id="ggab4a80a50db79ed975f645501bbf1a8faa9be42dd11086aff54e44377255afc73b" name="ggab4a80a50db79ed975f645501bbf1a8faa9be42dd11086aff54e44377255afc73b"></a>direct_message&#160;</td><td class="fielddoc"><p>Transmits a direct message from source to destination. </p>
<div class="image">
<img src="direct_message.png" alt=""/>
</div>
     </td></tr>
<tr><td class="fieldname"><a id="ggab4a80a50db79ed975f645501bbf1a8faa13a2104d37c15f89d76984ad250b4dac" name="ggab4a80a50db79ed975f645501bbf1a8faa13a2104d37c15f89d76984ad250b4dac"></a>routed_message&#160;</td><td class="fielddoc"><p>Transmits a message from <code>source_node:source_actor</code> to <code>dest_node:dest_actor</code>. </p>
<div class="image">
<img src="routed_message.png" alt=""/>
</div>
     </td></tr>
<tr><td class="fieldname"><a id="ggab4a80a50db79ed975f645501bbf1a8faab9538bc5d61173a7f4725e897a965f34" name="ggab4a80a50db79ed975f645501bbf1a8faab9538bc5d61173a7f4725e897a965f34"></a>monitor_message&#160;</td><td class="fielddoc"><p>Informs the receiving node that the sending node has created a proxy instance for one of its actors. </p>
<p>Causes the receiving node to attach a functor to the actor that triggers a down_message on termination.</p>
<div class="image">
<img src="monitor_message.png" alt=""/>
</div>
     </td></tr>
<tr><td class="fieldname"><a id="ggab4a80a50db79ed975f645501bbf1a8faa6bb532f246f78ce5fd450ab16f5f2026" name="ggab4a80a50db79ed975f645501bbf1a8faa6bb532f246f78ce5fd450ab16f5f2026"></a>down_message&#160;</td><td class="fielddoc"><p>Informs the receiving node that it has a proxy for an actor that has been terminated. </p>
<div class="image">
<img src="down_message.png" alt=""/>
</div>
     </td></tr>
<tr><td class="fieldname"><a id="ggab4a80a50db79ed975f645501bbf1a8faa3a06e053a0726537b202ce4ace81dee7" name="ggab4a80a50db79ed975f645501bbf1a8faa3a06e053a0726537b202ce4ace81dee7"></a>heartbeat&#160;</td><td class="fielddoc"><p>Used to generate periodic traffic between two nodes in order to detect disconnects. </p>
<div class="image">
<img src="heartbeat.png" alt=""/>
</div>
     </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaee0c93683f370496d4df9eed904c48c4" name="gaee0c93683f370496d4df9eed904c48c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaee0c93683f370496d4df9eed904c48c4">&#9670;&#160;</a></span>to_sec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sec caf::io::basp::to_sec </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#ga93565d04c32ae7fd8541faa8528137c9">connection_state</a></td>          <td class="paramname"><span class="paramname"><em>x</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Converts the connection state to a system error code if it holds one of the overlapping values. </p>
<p>Otherwise returns <code>sec::none</code>. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="gac9a0c0d3a0eb73be7c7149c7c124220a" name="gac9a0c0d3a0eb73be7c7149c7c124220a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac9a0c0d3a0eb73be7c7149c7c124220a">&#9670;&#160;</a></span>header_size</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t header_size</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">related</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= <span class="keyword">sizeof</span>(actor_id) * 2 + <span class="keyword">sizeof</span>(uint32_t) * 2</div>
<div class="line">                               + <span class="keyword">sizeof</span>(uint64_t)</div>
</div><!-- fragment -->
<p>Size of a BASP header in serialized form. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
